<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Quizio Dashboard</title>

<meta name="description" content="Quizio dashboard ‚Äì manage your educational games">
<meta name="theme-color" content="#0b57d0">

<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600&family=Nunito:wght@400;500;600&display=swap" rel="stylesheet">

<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

<style>
:root {
  --blue-main:#0b57d0;
  --blue-light:#1e88ff;
  --blue-soft:#eaf2ff;
  --text-dark:#1f2937;
  --text-muted:#6b7280;
  --border-soft:#e5e7eb;
  --radius-lg:16px;
  --radius-md:12px;
}
*{margin:0;padding:0;box-sizing:border-box}
body{
  height:100vh;
  display:flex;
  background:#f9fafb;
  font-family:'Nunito',sans-serif;
  color:var(--text-dark);
}

/* Loading overlay */
#loading {
  position:fixed;
  inset:0;
  background:rgba(15,23,42,.96);
  color:white;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.1rem;
  z-index:9999;
}

/* === YOUR ORIGINAL STYLES (UNCHANGED) === */
.sidebar{
  width:260px;
  background:var(--blue-main);
  color:white;
  padding:24px 20px;
  display:flex;
  flex-direction:column;
}
.logo{
  font-family:'Fredoka',sans-serif;
  font-size:32px;
  font-weight:600;
  margin-bottom:32px;
}
.profile{
  display:flex;
  gap:14px;
  align-items:center;
  margin-bottom:40px;
}
.avatar{
  width:56px;
  height:56px;
  border-radius:50%;
  background:#fff;
  color:var(--blue-main);
  font-weight:700;
  font-size:22px;
  display:flex;
  align-items:center;
  justify-content:center;
  overflow:hidden;
}
.avatar img{
  width:100%;
  height:100%;
  object-fit:cover;
}
.profile-info{
  font-size:15px;
  font-weight:500;
}
.profile-info span{
  display:block;
  font-size:13px;
  opacity:.85;
  font-weight:400;
}
.menu{flex:1}
.menu a{text-decoration:none}
.menu button{
  width:100%;
  background:none;
  border:none;
  color:white;
  padding:12px 14px;
  border-radius:12px;
  cursor:pointer;
  text-align:left;
  font-size:15px;
  font-family:'Fredoka',sans-serif;
  margin-bottom:8px;
}
.menu button:hover{
  background:rgba(255,255,255,.14);
}
.auth-buttons button{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  cursor:pointer;
  font-size:15px;
  font-family:'Fredoka',sans-serif;
  margin-bottom:12px;
}
.login{background:#38bdf8;color:white}
.main{
  flex:1;
  padding:28px 36px;
  display:flex;
  flex-direction:column;
}
.search-bar{
  max-width:820px;
  position:relative;
  margin-bottom:36px;
}
.search-bar input{
  width:100%;
  padding:14px 46px;
  border-radius:999px;
  border:1px solid var(--border-soft);
}
.search-icon{
  position:absolute;
  left:18px;
  top:50%;
  transform:translateY(-50%);
}
.empty-state{
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  gap:18px;
}
.empty-graphic{
  width:120px;
  height:120px;
  border-radius:50%;
  background:var(--blue-soft);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:46px;
}
.create-btn{
  padding:12px 22px;
  border-radius:999px;
  background:white;
  border:1px solid var(--border-soft);
  font-family:'Fredoka',sans-serif;
  cursor:pointer;
}
</style>
</head>

<body>

<div id="loading">Checking session‚Ä¶</div>

<aside class="sidebar">
  <div class="logo">Quizio</div>

  <div class="profile">
    <div class="avatar" id="avatar"></div>
    <div class="profile-info">
      <div id="profileName"></div>
      <span id="profileEmail"></span>
    </div>
  </div>

  <div class="menu">
    <a href="questioncreation.html"><button>‚ûï Create a Game Set</button></a>
    <button>üìò Book a Session</button>
  </div>

  <div class="auth-buttons">
    <button class="login" id="logoutBtn">Log out</button>
  </div>
</aside>

<main class="main">
  <div class="search-bar">
    <span class="search-icon">üîç</span>
    <input placeholder="Search your created question set here..." />
  </div>

  <div class="empty-state">
    <div class="empty-graphic">üéÆ</div>
    <p>No game set has been created yet!</p>
    <a href="questioncreation.html">
      <button class="create-btn">Click here to Create</button>
    </a>
  </div>
</main>

<script>
/* =======================
   SUPABASE CONFIG
======================= */
const supabase = window.supabase.createClient(
  "https://vobglhlucwodmlzphmvc.supabase.co",
  "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZvYmdsaGx1Y3dvZG1senBobXZjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY2NDI3NTUsImV4cCI6MjA4MjIxODc1NX0.TVsMoM0d_4wvrNfjAGid59FmCKBRYcqJMUC8MAEZg1A"
);

/* =======================
   ELEMENTS
======================= */
const nameEl = document.getElementById("profileName");
const emailEl = document.getElementById("profileEmail");
const avatarEl = document.getElementById("avatar");
const loadingEl = document.getElementById("loading");

/* =======================
   HELPERS
======================= */
function md5(str){
  return CryptoJS.MD5(str.trim().toLowerCase()).toString();
}

function loadAvatar(email, name){
  const img = new Image();
  img.src = `https://www.gravatar.com/avatar/${md5(email)}?d=404&s=200`;
  img.onload = () => avatarEl.innerHTML = `<img src="${img.src}">`;
  img.onerror = () => avatarEl.textContent = name[0].toUpperCase();
}

/* =======================
   AUTH GUARD
======================= */
(async () => {
  const { data, error } = await supabase.auth.getUser();

  if (error || !data.user) {
    window.location.replace("login.html");
    return;
  }

  const user = data.user;
  const name = user.user_metadata?.name || user.email.split("@")[0];

  nameEl.textContent = name;
  emailEl.textContent = user.email;
  loadAvatar(user.email, name);

  loadingEl.remove();
})();

/* =======================
   LOGOUT
======================= */
document.getElementById("logoutBtn").onclick = async () => {
  await supabase.auth.signOut();
  window.location.replace("login.html");
};
</script>

</body>
</html>

